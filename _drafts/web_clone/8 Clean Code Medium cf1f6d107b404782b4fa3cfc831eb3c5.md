# ç¬¬ 8 ç«  é‚Šç•Œ| Clean Code - æ‰‹å¯«ç­†è¨˜ - Medium

[https://medium.com/%E6%89%8B%E5%AF%AB%E7%AD%86%E8%A8%98/boundaries-774cae00dfbd](https://medium.com/%E6%89%8B%E5%AF%AB%E7%AD%86%E8%A8%98/boundaries-774cae00dfbd)

![1*Cbj_BcK5ePD4Mc4TK4sfvQ.jpeg](8%20Clean%20Code%20Medium%20cf1f6d107b404782b4fa3cfc831eb3c5/1Cbj_BcK5ePD4Mc4TK4sfvQ.jpeg)

```
ğŸ”– æ–‡ç« ç´¢å¼•1. èˆ‡ç¬¬ä¸‰æ–¹è»Ÿé«”çš„é‚Šç•Œ - å­¸ç¿’å¼æ¸¬è©¦
2. å·²çŸ¥èˆ‡æœªçŸ¥çš„é‚Šç•Œ - ä½¿ç”¨å°šæœªå­˜åœ¨çš„ç¨‹å¼
3. å°çµ
```

åœ¨æ›¸ä¸­è¬›çš„æœ‰å…©ç¨®**é‚Šç•Œ (Boundaries)**ï¼Œç¬¬ä¸€ç¨®æ˜¯**èˆ‡ç¬¬ä¸‰æ–¹è»Ÿé«”çš„é‚Šç•Œ**ï¼Œç¬¬äºŒç¨®æ˜¯**å·²çŸ¥èˆ‡æœªçŸ¥çš„é‚Šç•Œ**ã€‚æ›´ç™½è©±ä¸€é»ï¼Œé‚Šç•Œå°±æ˜¯ã€Œç¨‹å¼èˆ‡ç¨‹å¼çš„é‚Šç•Œã€ã€‚

# **èˆ‡ç¬¬ä¸‰æ–¹è»Ÿé«”çš„é‚Šç•Œ â€”Â å­¸ç¿’å¼æ¸¬è©¦**

æˆ‘å€‘åœ¨è»Ÿé«”ä¸­ç¶“å¸¸æœƒä¾è³´ç¬¬ä¸‰æ–¹çš„è»Ÿé«”ï¼Œå¦‚æœæ²’æœ‰å¥½çš„è¨­è¨ˆæˆ–æ˜¯ä¸€äº›å¥½çš„ç¿’æ…£ï¼Œå‰‡ä¸å®¹æ˜“ä¿æŒç³»çµ±**é‚Šç•Œ**çš„æ•´æ·ã€‚

è€Œæˆ‘å€‘ç¶“å¸¸éœ€è¦å¹¾å¤©çš„æ™‚é–“å­¸ç¿’ç¬¬ä¸‰æ–¹è»Ÿé«”ï¼Œåœ¨æ‘¸ç´¢çš„éç¨‹ä¸­é€šå¸¸æ˜¯èŠ±å¤§é‡çš„æ™‚é–“çœ‹ç¬¬ä¸‰æ–¹è»Ÿé«”çš„æ–‡ä»¶ï¼Œä»¥åŠå¯¦ä½œå®˜æ–¹æä¾›çš„ç¯„ä¾‹ç¨‹å¼ï¼Œæ€è€ƒç¬¬ä¸‰æ–¹è»Ÿé«”æ˜¯å¦‚ä½•ä½¿ç”¨åŠé‹ä½œã€‚

ä½†æ˜¯ï¼Œä½œè€…èªªé“ï¼Œèˆ‡å…¶æ²’æœ‰ç›®æ¨™çš„çœ‹å®˜æ–¹æ–‡ä»¶å­¸ç¿’ï¼Œä¸å¦‚æ’°å¯«**å­¸ç¿’å¼æ¸¬è©¦**ä¾†æ¢ç´¢èˆ‡äº†è§£ç¬¬ä¸‰æ–¹çš„è»Ÿé«”ï¼ŒJim Newkirk ç¨±é€™ç¨®æ–¹æ³•ç‚º**å­¸ç¿’å¼æ¸¬è©¦ (Learning tests)**ã€‚

# **å­¸ç¿’å¼æ¸¬è©¦æ¯”ä¸èŠ±åŠŸå¤«æ›´å¥½**

![https://miro.medium.com/max/750/0*3TwvCAKpNspUdy09.png](https://miro.medium.com/max/750/0*3TwvCAKpNspUdy09.png)

å–è‡ªÂ [https://pandas.pydata.org](https://pandas.pydata.org/)

å‡è¨­æˆ‘å€‘æƒ³è¦åœ¨ç³»çµ±ä¸­åŠ å…¥Â **[ğŸ”— äº¤é€šéƒ¨è§€å…‰å±€è§€å…‰çµ±è¨ˆè³‡æ–™åº«](https://stat.taiwan.net.tw/)**Â ä¸­çš„è³‡æ–™ï¼Œä¸¦ä¸”ä½¿ç”¨ pandas å¹«åŠ©æˆ‘å€‘è§£æ csv ä¸­éƒ¨ä»½çš„æ¬„ä½ã€‚æ‰€ä»¥ï¼Œæˆ‘å€‘å¿…é ˆé–±è®€Â **[ğŸ“– pandas çš„å®˜æ–¹æ–‡ä»¶](http://pandas.pydata.org/pandas-docs/stable/)**Â å­¸ç¿’æ€éº¼ä½¿ç”¨ç¬¬ä¸‰æ–¹è»Ÿé«” pandasã€‚

> ğŸ“Š è³‡æ–™ï¼šä¾†è‡ºæ—…å®¢æŒ‰å±…ä½åœ°çµ±è¨ˆ.csv

```python
class PandasLearningTest(unittest.TestCase):
    def setUp(self):
        self.csv = pd.read_csv("./ä¾†è‡ºæ—…å®¢æŒ‰å±…ä½åœ°çµ±è¨ˆ.csv")

    def test_output_csv(self):
        self.csv.to_csv("output.csv")

    def test_output_csv_without_index(self):
        self.csv.to_csv("output.csv", index=False)

    def test_calculate_number_of_tourists(self):
        csv = self.csv.iloc[1:-1]
        region = ['äºæ´²åœ°å€', 'éæ´²åœ°å€', 'ç¾æ´²åœ°å€', 'å¤§æ´‹æ´²åœ°å€', 'æ­æ´²åœ°å€', 'å…¶ä»–æœªåˆ—æ˜']
        number_of_tourists = csv.astype('int').sum()[region]

    def test_calculate_number_of_tourists_in_asia(self):
        csv = self.csv.iloc[1:-1]
        number_of_tourists = csv.astype('int').sum()
        region = ['äºæ´²åœ°å€']
        number_of_asia_tourists = number_of_tourists[region]

    def test_calculate_number_of_tourists_after_105(self):
        csv = self.csv.iloc[1:-1]
        number_of_tourists_after_105 = csv[csv.loc[:, 'å¹´åˆ¥'].astype('int') > 105]
```

åœ¨ç¶“æ­·äº†ä¸€ç•ªè‹¦æˆ°ä¹‹å¾Œï¼Œæˆ‘å€‘ç™¼ç¾äº†ä¸€äº› pandas ä½¿ç”¨çš„æŠ€å·§ï¼Œä¸¦ä¸”å°‡é€™äº›çŸ¥è­˜å»ºç«‹æˆä¸€äº›ç°¡å–®çš„å–®å…ƒæ¸¬è©¦ã€‚

**é€™äº›è¢«å°è£çš„çŸ¥è­˜å°±æ˜¯é‚Šç•Œ**ï¼Œç¾éšæ®µï¼Œå®ƒå€‘æ‡‰ç”¨åˆ°æˆ‘å€‘çš„ç³»çµ±ä¸­æ™‚ï¼Œå› ç‚ºé€šéäº†å–®å…ƒæ¸¬è©¦ï¼Œä¸æœƒå¼•ç™¼ä»»ä½•çš„å•é¡Œã€‚

ä½†æ˜¯ï¼Œå¦‚æœæœªä¾†ç‚ºäº†æ»¿è¶³æ›´å¤šçš„éœ€æ±‚é€²è¡Œå‡ç´šäº† pandas çš„ç‰ˆæœ¬ï¼Œæˆ–æ˜¯è³‡æ–™åº«è¢«ä¿®æ”¹äº†ä¸€äº›æ¬„ä½ï¼ŒèˆŠæœ‰çš„ç¨‹å¼ç¢¼ä¸ä¸€å®šæœƒç›¸å®¹æ–¼ç¾éšæ®µçš„ç³»çµ±ã€‚å› æ­¤ï¼Œå‡è¨­æœªä¾†å‡ç´šæ™‚ï¼Œç„¡æ³•é€šéæˆ‘å€‘å…ˆå‰æ’°å¯«çš„å–®å…ƒæ¸¬è©¦ï¼Œæˆ‘å€‘å°±èƒ½å¤ ç«‹å³ç™¼ç¾å•é¡Œã€‚

> è€Œé€™äº›æ¸¬è©¦ï¼Œä½œè€…ç¨±ç‚ºé‚Šç•Œæ¸¬è©¦ï¼Œå¯ä»¥æ¸›è¼•å‡ç´šæ•´åˆæ‰€é€ æˆçš„è² æ“”ã€‚

---

# **å·²çŸ¥èˆ‡æœªçŸ¥çš„é‚Šç•Œ â€” ä½¿ç”¨å°šæœªå­˜åœ¨çš„ç¨‹å¼**

å‡è¨­ï¼Œä½ çš„åœ˜éšŠè¦å¯«ä¸€å€‹çµ±è¨ˆå°ç£è§€å…‰æ•¸æ“šçš„ç¶²ç«™ï¼Œè€Œåœ˜éšŠåªæœ‰å…©åæˆå“¡ï¼›ä½ è² è²¬é–‹ç™¼ä»‹æ¥ API çš„ç¨‹å¼ï¼Œè€Œä½ çš„éšŠå‹è² è²¬æ’°å¯« APIã€‚ä½†æ˜¯ï¼Œä½ çš„éšŠå‹æ­£åœ¨*å­¸ç¿’å¦‚ä½•ä½¿ç”¨ pandas èˆ‡äº¤é€šéƒ¨è§€å…‰å±€è§€å…‰çµ±è¨ˆè³‡æ–™åº«*ï¼Œæ‰€ä»¥ä½ é‚„ä¸çŸ¥é“ API é•·ä»€éº¼æ¨£å­ã€‚

![https://miro.medium.com/max/589/1*fsQ20oEhZ5xoxu9ItbPIFw.png](https://miro.medium.com/max/589/1*fsQ20oEhZ5xoxu9ItbPIFw.png)

> Uncle Bobï¼šã€Œæˆ‘å€‘ä¸¦ä¸æƒ³å› æ­¤è¢«å›°ä½ï¼Œæ‰€ä»¥æˆ‘å€‘åœ¨é›¢é€™å¡ŠæœªçŸ¥çš„ç¨‹å¼ç¢¼æ¯”è¼ƒé çš„åœ°æ–¹ï¼Œå±•é–‹æˆ‘å€‘çš„å·¥ä½œã€‚ã€

é›–ç„¶ä½ é‚„ä¸çŸ¥é“ Statistic API çš„æ¨¡æ¨£ï¼Œä½†æ˜¯ä»ç„¶èƒ½å¤ **æƒ³åƒé‚£å€‹é‚Šç•Œä»‹é¢é•· (Statistic Interface)**Â ä»€éº¼æ¨£å­ã€‚æˆ‘å€‘å¸Œæœ›é‚£å€‹ä»‹é¢å¯ä»¥ï¼š

> çµ±è¨ˆæ¯å€‹å€åŸŸæˆ–æ˜¯å·çš„è§€å…‰äººæ•¸ï¼Œä»¥åŠçµ±è¨ˆè”¡ç¸½çµ±ä¸Šä»»å¾Œçš„è§€å…‰äººæ•¸ã€‚

æ‰€ä»¥ï¼Œæˆ‘å€‘å°‡å·²çŸ¥èˆ‡æœªçŸ¥çš„é‚Šç•Œä½¿ç”¨ä»‹é¢éš”é›¢é–‹ä¾†ï¼Œé€™æ™‚å€™ä½ å°±å¯ä»¥ç¹¼çºŒæ’°å¯« Controller ä»‹æ¥ API çš„ç¨‹å¼ã€‚åœ¨ Statistic API é‚„æ²’é–‹ç™¼å®Œæˆå‰ï¼Œå…ˆä½¿ç”¨ä¸€å€‹å‡çš„ Fake Statisticï¼Œèƒ½å¤ è®“ Controller é †åˆ©åœ°å‹•èµ·ä¾†ã€‚

å› æ­¤ï¼Œä½ ç”šè‡³å¯ä»¥æ’°å¯« Controller çš„å–®å…ƒæ¸¬è©¦ï¼Œä¸å¿…ç­‰å¾… Statistic API é–‹ç™¼å®Œæˆã€‚

![https://miro.medium.com/max/8676/1*hRtNC4lqOBCCHOGnXgqFNw.png](https://miro.medium.com/max/8676/1*hRtNC4lqOBCCHOGnXgqFNw.png)

åœ¨ Statistic API é–‹ç™¼å®Œæˆå¾Œï¼Œä½ å°±å¯ä»¥æ’°å¯« Statistic Adapterï¼Œè€Œå®ƒèˆ‡ Fake Statistic ç¹¼æ‰¿åŒæ¨£çš„ä»‹é¢ï¼Œæ‰€ä»¥ Controller ä¹Ÿä¸å¿…ä¿®æ”¹ã€‚æ­¤æ™‚çš„ä½ ä¹Ÿèƒ½å¤ å°ˆå¿ƒæ’°å¯« Statistic Adapter çš„ç¨‹å¼ç¢¼ï¼Œä¹Ÿèƒ½åŒæ™‚ç”¢ç”Ÿ**é‚Šç•Œæ¸¬è©¦**ï¼Œå»ä¿ä½ å€‘æ­£ç¢ºä½¿ç”¨ APIã€‚

æœ€å¾Œåªè¦æŠŠåœ¨ Controller å‘¼å«çš„ Fake Statistic ç‰©ä»¶æ›¿æ›æˆ Statistic Adapter ç‰©ä»¶ï¼ŒController å°±å¯ä»¥é †åˆ©æ¥ä¸Š Statistic APIã€‚

> é€™ç¨®åšæ³•å¯ä»¥åƒè€ƒÂ ğŸ”— [Design Patterns â€” Adapter Pattern](http://design%20patterns%20-%20adapter%20pattern/)

æ¡ç”¨é€™ç¨®è¨­è¨ˆï¼ŒAdapter å°è£äº†èˆ‡ API çš„äº’å‹•ï¼Œç•¶ API å‡ç´šæ™‚ï¼ŒAdapter æ˜¯å”¯ä¸€éœ€è¦è¢«ä¿®æ”¹çš„åœ°æ–¹ã€‚

```python
import abc

class Statistic(metaclass=abc.ABCMeta):
    @abc.abstractmethod
    def calculate_tourist_summary(self):
        pass

    @abc.abstractmethod
    def calculate_tourist_summary_after_105(self):
        pass

class FakeStatistic(Statistic):
    def calculate_tourist_summary(self):
        do something...

    def calculate_tourist_summary_after_105(self):
        do something...

class StatisticAdapter(Statistic):
    def calculate_tourist_summary(self):
        to do...
    
    def calculate_tourist_summary_after_105(self):
        to do...
```

# **å°çµ**

åœ¨é€™å€‹ç« ç¯€ï¼Œæˆ‘å€‘å­¸åˆ° 1ï¸âƒ£Â **é‚Šç•Œæ¸¬è©¦**Â èˆ‡ 2ï¸âƒ£Â **Adapter**ï¼Œå®ƒå€‘éƒ½æ˜¯ç‚ºäº†è®“æˆ‘å€‘èƒ½å¤ æœ‰æ•ˆåœ°æŒæ§é‚Šç•Œçš„å€åŸŸã€‚

ä½œè€…å‘Šè¨´æˆ‘å€‘ï¼Œé‚Šç•Œæ˜¯ä¸€å€‹äº¤æˆ°éå¸¸çŒ›çƒˆçš„å€åŸŸã€‚ä¸è«–æ˜¯ä¾è³´ç¬¬ä¸‰æ–¹çš„è»Ÿé«”ï¼Œæˆ–æ˜¯é¢å°æœªçŸ¥çš„é‚Šç•Œï¼Œä¸€ä¸å°å¿ƒï¼Œå°±æœ‰å¯èƒ½è®“æˆ°ç«ä¸€ç™¼ä¸å¯æ”¶æ‹¾ã€‚

æˆ‘å€‘å¿…é ˆæ§ç®¡é€™äº›é‚Šç•Œï¼Œæ‰€ä»¥æˆ‘å€‘éœ€è¦ä½¿ç”¨æœ€å°‘é‡çš„ç¨‹å¼ç¢¼å°‡å®ƒå€‘å°è£èµ·ä¾†ï¼ŒæŠŠé‚Šç•Œéš”é›¢å‡ºä¾†ï¼ŒæŠŠ**ä¸»å°æ¬Šæ”¾åœ¨æˆ‘å€‘èƒ½å¤ æ§åˆ¶çš„ç¨‹å¼ä¸Š**ã€‚

# **âœ‹ å»¶ä¼¸é–±è®€**

**[ç¬¬ 9 ç«  å–®å…ƒæ¸¬è©¦| Clean Code**Uncle Bob:ã€Œä»€éº¼æ˜¯ä¸€å€‹æ•´æ½”çš„æ¸¬è©¦ï¼Ÿä¸‰ä»¶äº‹ï¼Œå¯è®€æ€§ï¼Œå¯è®€æ€§ï¼Œé‚„æ˜¯å¯è®€æ€§ã€‚ã€medium.com](https://medium.com/%E6%89%8B%E5%AF%AB%E7%AD%86%E8%A8%98/unit-tests-ecc8ed18d583)